package com.koushr.kafka_producer_test.controller;

import com.google.common.collect.ImmutableMap;
import com.koushr.kafka_producer_test.init.KafkaConnector;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.kafka.clients.producer.ProducerRecord;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

@RestController
public class KafkaController {
    private static final Log log = LogFactory.getLog(KafkaController.class);

    @Autowired
    private KafkaConnector kafkaConnector;

    @RequestMapping(value = "/produce", method = {RequestMethod.POST, RequestMethod.GET})
    public Map<String, Object> produce() {
        List<String> list = new ArrayList<>();
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94ee59a6426a1e92d57bb\",\"risk_target\":\"bba07f139a8b7548e8b6b02a0b51de8c\",\"risk_target_name\":\"{GET}/getPublicKey\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"APPLICATION_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d829a6426a1e92d5644\",\"risk_target\":\"a1573c4989a070d51d69ec85a08a913c\",\"risk_target_name\":\"{GET}/sysuser/info/bingCheck\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"APPLICATION_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"38.151.94.57\",\"risk_target_name\":\"38.151.94.57\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"84.219.112.194\",\"risk_target_name\":\"84.219.112.194\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"251.97.255.44\",\"risk_target_name\":\"251.97.255.44\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"bba07f139a8b7548e8b6b02a0b51de8c\",\"risk_target_name\":\"{GET}/getPublicKey\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"193.234.8.6\",\"risk_target_name\":\"193.234.8.6\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d829a6426a1e92d5644\",\"risk_target\":\"bba07f139a8b7548e8b6b02a0b51de8c\",\"risk_target_name\":\"{GET}/getPublicKey\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"APPLICATION_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"81.96.242.42\",\"risk_target_name\":\"81.96.242.42\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 9
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"dc034e07d7a93b7c7fe0217689d3f593\",\"risk_target_name\":\"{POST}/user/login\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 10
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"9d43ad59ee5cec383ee5f63a7111245c\",\"risk_target_name\":\"{POST}/user/login\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 11
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94ee59a6426a1e92d57bb\",\"risk_target\":\"7adc564a79a0932e6c4aa7e9fca0cf72\",\"risk_target_name\":\"{GET}/getPublicKey\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"APPLICATION_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 12
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"cd730842d754b96035402b72b0ef40ef\",\"risk_target_name\":\"{POST}/user/login\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 13
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"48.128.219.210\",\"risk_target_name\":\"48.128.219.210\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 14
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"155.242.107.112\",\"risk_target_name\":\"155.242.107.112\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 15
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"197.0.246.192\",\"risk_target_name\":\"197.0.246.192\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 16
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"752fa3fb0efe28219109bb8122fa265b\",\"risk_target_name\":\"{POST}/user/login\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 17
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94ee59a6426a1e92d57bb\",\"risk_target\":\"60fc2cfd0f3e5fd70254cc99ff72b77e\",\"risk_target_name\":\"{GET}/getPublicKey\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"APPLICATION_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 18
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"183.0.204.238\",\"risk_target_name\":\"183.0.204.238\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 19
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"360eefad233115ca670a4783a500e4a8\",\"risk_target_name\":\"{POST}/user/login\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 20
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94ee59a6426a1e92d57bb\",\"risk_target\":\"06c0c1943eb3ecbb78da4d049fbe0ea2\",\"risk_target_name\":\"{GET}/getPublicKey\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"APPLICATION_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 21
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"03877a8d50c6cbc6f9ca7c5904a287c8\",\"risk_target_name\":\"{POST}/user/login\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 22
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94ee59a6426a1e92d57bb\",\"risk_target\":\"46573eeb0f0c643a995a736a25a4019a\",\"risk_target_name\":\"{GET}/getPublicKey\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"APPLICATION_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 23
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94ee59a6426a1e92d57bb\",\"risk_target\":\"752fa3fb0efe28219109bb8122fa265b\",\"risk_target_name\":\"{GET}/getPublicKey\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"APPLICATION_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 24
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"7adc564a79a0932e6c4aa7e9fca0cf72\",\"risk_target_name\":\"{POST}/user/login\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 25
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"d68b6e1240f854f3e11b6f398092cc3b\",\"risk_target_name\":\"{POST}/user/login\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 26
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"219.196.29.54\",\"risk_target_name\":\"219.196.29.54\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 27
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"56.55.115.17\",\"risk_target_name\":\"56.55.115.17\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 28
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"10.10.30.141\",\"risk_target_name\":\"10.10.30.141\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 29
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94d1a9a6426a1e92d55db\",\"risk_target\":\"1c54f72d9c14332b0682b7d6a9e90ed3\",\"risk_target_name\":\"{POST}/user/login\",\"risk_target_type\":\"ENDPOINT\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 30
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"21.226.116.160\",\"risk_target_name\":\"21.226.116.160\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");
        // 31
        list.add("{\"description\":\"访问接口时间: 2022-10-12 14:26:05,访问接口时间: 2022-10-12 14:26:05\",\"strategy_id\":\"62b94cae9a6426a1e92d556e\",\"risk_target\":\"82.120.127.193\",\"risk_target_name\":\"82.120.127.193\",\"risk_target_type\":\"IP\",\"risk_level\":\"LOW\",\"risk_category\":\"DATA_RISK\",\"related_logs\":[\"NL:6f1ba4a0-f361-4234-a91e-4baeb29bbcb3\"],\"related_apps\":[\"shengwen-8-1\"],\"violated_rules\":[\"工作时间访问1\",\"工作时间访问2\"],\"type\":0,\"status\":\"\",\"matched_data\":{\"phase\":0,\"variable\":\"\",\"key\":\"\",\"value\":\"\"}}");

        for (int i = 0; i < list.size() * 10000000; i++) {
            ProducerRecord<String, String> producerRecord = new ProducerRecord<>("htcc_risks", list.get(i % list.size()));
            kafkaConnector.getProducer().send(producerRecord
//                    (RecordMetadata metadata, Exception exception) -> {
//                log.info("metadata topic= " + metadata.topic() + ", partition= " + metadata.partition() + ", offset= " + metadata.offset() + ", timestamp= " + metadata.timestamp());
//                if (exception != null) {
//                    log.info("exception= " + exception);
//                }
//            }
            );
        }
        log.info("end");
        return ImmutableMap.of("status", "success");
    }
}
